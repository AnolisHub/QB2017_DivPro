author: "Katie Beidler"
warnings()
devtools::install_github("rstudio/rmarkdown")
install.packages("devtools")
devtools::install_github("rstudio/rmarkdown")
Sys.setenv("DISPLAY"=":0")
require(shiny)
title: 'Assignment: Temporal Diversity'
author: 'Katie Beidler; Z620: Quantitative Biodiversity, Indiana University'
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: pdf_document
geometry: margin=2.54cm
sessionInfo()
locale
knit_with_parameters('~/GitHub/QB2017_Beidler/Week5-Temporal/temporal_assignment.Rmd')
library(lme)
package.list = c('vegan', 'tidyr', 'dplyr', 'codyn', 'ggplot2','betapart','splitstackshape',
'cowplot', 'MullerPlot', 'RColorBrewer','lubridate', 'reshape2', 'lubridate','wesanderson',
'TTR', 'xtable', 'multcomp', 'pander', 'png', 'grid', 'tseries', 'nlme', 'forecast', 'lsmeans', 'devtools')
for (package in package.list) {
if (!require(package, character.only = TRUE, quietly = TRUE)) {
install.packages(package, repos='http://cran.us.r-project.org')
library(package, character.only = TRUE) }
}
clr = function() {
ENV = globalenv()
ll = ls(envir = ENV)
ll = ll[ll != "clr"]
rm(list = ll, envir = ENV)
}
getwd()
setwd("/Users/bhbeidler/GitHub/QB2017_DivPro/Data")
package.list = c('vegan', 'tidyr', 'dplyr', 'codyn', 'ggplot2','betapart','splitstackshape',
'cowplot', 'MullerPlot', 'RColorBrewer','lubridate', 'reshape2', 'lubridate','wesanderson',
'TTR', 'xtable', 'multcomp', 'pander', 'png', 'grid', 'tseries', 'nlme', 'forecast', 'lsmeans', 'devtools')
for (package in package.list) {
if (!require(package, character.only = TRUE, quietly = TRUE)) {
install.packages(package, repos='http://cran.us.r-project.org')
library(package, character.only = TRUE) }
}
setwd("/Users/bhbeidler/GitHub/QB2017_DivPro/Data")
plant = read.csv("./HF_plants_treat.csv")
nmin = read.csv("./HF_nmin.csv", stringsAsFactors = FALSE)
resp = read.csv("./HF_soilresp.csv", stringsAsFactors = FALSE)
# Making the Site by Species Matrix for the plant data set
plant_sbys = plant[ ,6:43]
# Subsetting the data into the different years
plant_06 = (filter(plant, year == 2006))
plant_07 = (filter(plant, year == 2007))
plant_08 = (filter(plant, year == 2008))
plant_09 = (filter(plant, year == 2009))
# Separating out the treatments from the site by species matrices
plant_06_sbys = plant_06[ ,6:43]
plant_07_sbys = plant_07[ ,6:43]
plant_08_sbys = plant_08[ ,6:43]
plant_09_sbys = plant_09[ ,6:43]
# Visualizing the Plant data set
str(plant, max.level = 1)
# Calculate observed richness from time-by-species matrix
p_richness = as.data.frame(rowSums(plant[,-c(1:5)] > 0))
# Create data frame with experimental design and richness data
p_rich.all = data.frame(plant[,1:5,], p_richness)
# Rename column
names(p_rich.all)[6] = "richness"
# avg. richness per group
# stand. dev. per group
# num. obs. per group
# calc. std. err. mean.
p_rich.treat.plot = group_by(p_rich.all, treatment, year) %>%
summarise(mean = mean(richness), sd = sd(richness),n = n(),sem = sd/sqrt(n))
p_rich.plot = ggplot(p_rich.treat.plot, aes(x = year, y = mean, color = as.factor(treatment))) +
geom_point(size = 2, show.legend = T) +
geom_line(size = 0.75) +
geom_errorbar(aes(ymin = mean - sem, ymax = mean + sem), width = .1) +
scale_color_manual(values = c("#999999", "#E69F00", "#000000", "#56B4E9"),name="Soil Treatment",labels=c("Unheated-Unfertilized", "Heated-Unfertilized", "Heated- Fertilized", "Unheated-Fertilized")) +
xlim(2006, 2009) + xlab("Year") + ylab("Richness") +
theme_classic(base_size=15)+
theme(axis.line.x = element_line(color = "black"), axis.line.y = element_line(color ="black"))
plot(p_rich.plot)
# Calculate diveristy from time-by-species matrix
p_diversity = diversity(plant[,-c(1:5)], "shannon")
# Create data frame with experimental design and diversity data
p_div.all = data.frame(plant[,1:5,], p_diversity)
# Rename column
names(p_div.all)[6] = "diversity"
p_div.treat.plot = group_by(p_div.all, treatment, year) %>%
summarise(mean = mean(diversity), sd = sd(diversity),n = n(),sem = sd/sqrt(n))
p_div.plot = ggplot(p_div.treat.plot, aes(x = year, y = mean, color = as.factor(treatment))) +
geom_point(size = 2, show.legend = T) +
geom_line(size = 0.75) +
geom_errorbar(aes(ymin = mean - sem, ymax = mean + sem), width = .1) +
scale_color_manual(values = c("#999999", "#E69F00", "#000000", "#56B4E9"),name="Soil Treatment",labels=c("Unheated-Unfertilized", "Heated-Unfertilized", "Heated- Fertilized", "Unheated-Fertilized")) +
xlim(2006, 2009) + xlab("Year") + ylab("Shannon's Diversity Index")+
theme_classic(base_size=15)+
theme(axis.line.x = element_line(color = "black"),axis.line.y = element_line(color = "black"))
plot(p_div.plot)
help(lme)?
)
?lme
View(resp)
# Soil respiration
resp = resp %>%
filter(year %in% c("2006", "2007", "2008", "2009"))
resp$date = as.Date(resp$date, format = "%m/%d/%Y")
resp$doy = yday(resp$date)
resp_yr.plot = qplot(doy, co2flux, data = resp, geom="smooth") +
stat_smooth(fill="azure3", colour="mediumpurple4", size=1, alpha = 0.2) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line =   element_line(colour = "black")) +
facet_wrap(~year, ncol = 1)
xlab("Day of the Year") +
ylab("CO2 Flux")
resp_yr.plot + theme(text = element_text(size=18), plot.title = element_text(lineheight=.8, face="bold")) + ggtitle("Soil Respiration 2006-2009")
plot(resp_yr.plot)
resp_trt.plot = qplot(doy, co2flux, data = resp, colour = as.factor(trt), geom="smooth", se=FALSE) +
stat_smooth(method ="auto",se = FALSE, formula = y ~ x, size = 1) +
facet_wrap(~year, ncol = 1) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))
resp_trt.plot + scale_colour_brewer(type="seq", palette=3) + xlab("Day of the Year") +ylab("CO2 Flux)") + theme(text = element_text(size=18))
plot(resp_trt.plot)
# N mineralization
nmin = nmin %>%
filter(year %in% c( "2007", "2008"))
nmin$date = as.Date(nmin$date, format = "%m/%d/%Y")
nmin$doy = yday(nmin$date)
nmin = na.remove(nmin)
n03_yr.plot = qplot(doy, netno3, data = nmin, geom="smooth") +
stat_smooth(fill="azure3", colour="mediumpurple4", size=1, alpha = 0.2) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line =   element_line(colour = "black")) +
facet_wrap(hor~year)
xlab("Day of the Year") +
ylab("Net Nitrate")
nmin_yr.plot + theme(text = element_text(size=18), plot.title = element_text(lineheight=.8, face="bold")) + ggtitle("Soil NO3 2006-2009")
plot(n03_yr.plot)
nh4_yr.plot = qplot(doy, netnh4, data = nmin, geom="smooth") +
stat_smooth(fill="azure3", colour="mediumpurple4", size=1, alpha = 0.2) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line =   element_line(colour = "black")) +
facet_wrap(hor~year)
xlab("Day of the Year") +
ylab("Net Ammonium")
nh4_yr.plot + theme(text = element_text(size=18), plot.title = element_text(lineheight=.8, face="bold")) + ggtitle("Soil NO3 2006-2009")
plot(nh4_yr.plot)
no3_trt.plot = qplot(doy, netnh4, data = nmin, colour = as.factor(trt), geom="smooth", se=FALSE) +
stat_smooth(method ="auto",se = FALSE, formula = y ~ x, size = 1) +
facet_wrap(hor~year) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))
resp_trt.plot + scale_colour_brewer(type="seq", palette=3) + xlab("Day of the Year") +ylab("Total NO3)") + theme(text = element_text(size=18))
plot(no3_trt.plot)
nh4_trt.plot = qplot(doy, netnh4, data = nmin, colour = as.factor(trt), geom="smooth", se=FALSE) +
stat_smooth(method ="auto",se = FALSE, formula = y ~ x, size = 1) +
facet_wrap(hor~year) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))
nh4_trt.plot + scale_colour_brewer(type="seq", palette=3) + xlab("Day of the Year") +ylab("Total NH4)") + theme(text = element_text(size=18))
plot(nh4_trt.plot)
# Soil respiration
resp = resp %>%
filter(year %in% c("2006", "2007", "2008", "2009"))
resp$date = as.Date(resp$date, format = "%m/%d/%Y")
resp$doy = yday(resp$date)
resp_yr.plot = qplot(doy, co2flux, data = resp, geom="smooth") +
stat_smooth(fill="azure3", colour="mediumpurple4", size=1, alpha = 0.2) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line =   element_line(colour = "black")) +
facet_wrap(~year, ncol = 1)
xlab("Day of the Year") +
ylab("CO2 Flux")
resp_yr.plot + theme(text = element_text(size=18), plot.title = element_text(lineheight=.8, face="bold")) + ggtitle("Soil Respiration 2006-2009")
plot(resp_yr.plot)
resp_trt.plot = qplot(doy, co2flux, data = resp, colour = as.factor(trt), geom="smooth", se=FALSE) +
stat_smooth(method ="auto",se = FALSE, formula = y ~ x, size = 1) +
facet_wrap(~year, ncol = 1) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))
resp_trt.plot + scale_colour_brewer(type="seq", palette=3) + xlab("Day of the Year") +ylab("CO2 Flux)") + theme(text = element_text(size=18))
plot(resp_trt.plot)
# N mineralization
nmin = nmin %>%
filter(year %in% c("2006","2007", "2008", "2009"))
nmin$date = as.Date(nmin$date, format = "%m/%d/%Y")
nmin$doy = yday(nmin$date)
nmin = na.remove(nmin)
n03_yr.plot = qplot(doy, netno3, data = nmin, geom="smooth") +
stat_smooth(fill="azure3", colour="mediumpurple4", size=1, alpha = 0.2) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line =   element_line(colour = "black")) +
facet_wrap(hor~year)
xlab("Day of the Year") +
ylab("Net Nitrate")
nmin_yr.plot + theme(text = element_text(size=18), plot.title = element_text(lineheight=.8, face="bold")) + ggtitle("Soil NO3 2006-2009")
plot(n03_yr.plot)
nh4_yr.plot = qplot(doy, netnh4, data = nmin, geom="smooth") +
stat_smooth(fill="azure3", colour="mediumpurple4", size=1, alpha = 0.2) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line =   element_line(colour = "black")) +
facet_wrap(hor~year)
xlab("Day of the Year") +
ylab("Net Ammonium")
nh4_yr.plot + theme(text = element_text(size=18), plot.title = element_text(lineheight=.8, face="bold")) + ggtitle("Soil NO3 2006-2009")
plot(nh4_yr.plot)
no3_trt.plot = qplot(doy, netnh4, data = nmin, colour = as.factor(trt), geom="smooth", se=FALSE) +
stat_smooth(method ="auto",se = FALSE, formula = y ~ x, size = 1) +
facet_wrap(hor~year) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))
resp_trt.plot + scale_colour_brewer(type="seq", palette=3) + xlab("Day of the Year") +ylab("Total NO3)") + theme(text = element_text(size=18))
plot(no3_trt.plot)
nh4_trt.plot = qplot(doy, netnh4, data = nmin, colour = as.factor(trt), geom="smooth", se=FALSE) +
stat_smooth(method ="auto",se = FALSE, formula = y ~ x, size = 1) +
facet_wrap(hor~year) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))
nh4_trt.plot + scale_colour_brewer(type="seq", palette=3) + xlab("Day of the Year") +ylab("Total NH4)") + theme(text = element_text(size=18))
plot(nh4_trt.plot)
View(resp)
soil.rm1 = lme(co2flux ~ trt * year, random = ~ 1 | plot, correlation = corAR1(form = ~ 1 | resp),data = resp) # Look at detailed output
summary(soil.rm1) # Obtain F-test
anova(soil.rm1)
lme(co2flux ~ trt * year, random = ~ 1 | plot, correlation = corAR1(form = ~ 1 | resp),data = resp)
soil.rm1 = lme(co2flux ~ trt * year, random = ~ 1 | plot, correlation = corAR1(form = ~ 1 | plot),data = resp) # Look at detailed output
summary(soil.rm1) # Obtain F-test
anova(soil.rm1)
lme(co2flux ~ trt * year, random = ~ 1 | plot, correlation = corAR1(form = ~ 1 | plot),data = resp)
resp = na.remove(resp)
lme(co2flux ~ trt * year, random = ~ 1 | plot, correlation = corAR1(form = ~ 1 | plot),data = resp)
lme(co2flux ~ trt * year, random = ~ 1 | as.factor(plot), correlation = corAR1(form = ~ 1 | as.factor(plot)),data = resp)
resp = na.exclude(resp)
lme(co2flux ~ trt * year, random = ~ 1 | plot, correlation = corAR1(form = ~ 1 | plot),data = resp)
resp_yr.plot = qplot(doy, co2flux, data = resp, geom="smooth") +
stat_smooth(fill="azure3", colour="mediumpurple4", size=1, alpha = 0.2) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line =   element_line(colour = "black")) +
facet_wrap(~year, ncol = 1)
xlab("Day of the Year") +
ylab("CO2 Flux")
resp_yr.plot + theme(text = element_text(size=18), plot.title = element_text(lineheight=.8, face="bold")) + ggtitle("Soil Respiration 2006-2009")
plot(resp_yr.plot)
resp_trt.plot = qplot(doy, co2flux, data = resp, colour = as.factor(trt), geom="smooth", se=FALSE) +
stat_smooth(method ="auto",se = FALSE, formula = y ~ x, size = 1) +
facet_wrap(~year, ncol = 1) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))
resp_trt.plot + scale_colour_brewer(type="seq", palette=3) + xlab("Day of the Year") +ylab("CO2 Flux)") + theme(text = element_text(size=18))
plot(resp_trt.plot)
# Soil respiration
resp = resp %>%
filter(year %in% c( "2007", "2008", "2009"))
resp$date = as.Date(resp$date, format = "%m/%d/%Y")
resp$doy = yday(resp$date)
resp = na.exclude(resp)
resp_yr.plot = qplot(doy, co2flux, data = resp, geom="smooth") +
stat_smooth(fill="azure3", colour="mediumpurple4", size=1, alpha = 0.2) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line =   element_line(colour = "black")) +
facet_wrap(~year, ncol = 1)
xlab("Day of the Year") +
ylab("CO2 Flux")
resp_yr.plot + theme(text = element_text(size=18), plot.title = element_text(lineheight=.8, face="bold")) + ggtitle("Soil Respiration 2006-2009")
plot(resp_yr.plot)
resp_trt.plot = qplot(doy, co2flux, data = resp, colour = as.factor(trt), geom="smooth", se=FALSE) +
stat_smooth(method ="auto",se = FALSE, formula = y ~ x, size = 1) +
facet_wrap(~year, ncol = 1) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))
resp_trt.plot + scale_colour_brewer(type="seq", palette=3) + xlab("Day of the Year") +ylab("CO2 Flux)") + theme(text = element_text(size=18))
plot(resp_trt.plot)
# N mineralization
nmin = nmin %>%
filter(year %in% c("2006","2007", "2008", "2009"))
nmin$date = as.Date(nmin$date, format = "%m/%d/%Y")
nmin$doy = yday(nmin$date)
nmin = na.remove(nmin)
n03_yr.plot = qplot(doy, netno3, data = nmin, geom="smooth") +
stat_smooth(fill="azure3", colour="mediumpurple4", size=1, alpha = 0.2) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line =   element_line(colour = "black")) +
facet_wrap(hor~year)
xlab("Day of the Year") +
ylab("Net Nitrate")
nmin_yr.plot + theme(text = element_text(size=18), plot.title = element_text(lineheight=.8, face="bold")) + ggtitle("Soil NO3 2006-2009")
plot(n03_yr.plot)
nh4_yr.plot = qplot(doy, netnh4, data = nmin, geom="smooth") +
stat_smooth(fill="azure3", colour="mediumpurple4", size=1, alpha = 0.2) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line =   element_line(colour = "black")) +
facet_wrap(hor~year)
xlab("Day of the Year") +
ylab("Net Ammonium")
nh4_yr.plot + theme(text = element_text(size=18), plot.title = element_text(lineheight=.8, face="bold")) + ggtitle("Soil NO3 2006-2009")
plot(nh4_yr.plot)
no3_trt.plot = qplot(doy, netnh4, data = nmin, colour = as.factor(trt), geom="smooth", se=FALSE) +
stat_smooth(method ="auto",se = FALSE, formula = y ~ x, size = 1) +
facet_wrap(hor~year) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))
resp_trt.plot + scale_colour_brewer(type="seq", palette=3) + xlab("Day of the Year") +ylab("Total NO3)") + theme(text = element_text(size=18))
plot(no3_trt.plot)
nh4_trt.plot = qplot(doy, netnh4, data = nmin, colour = as.factor(trt), geom="smooth", se=FALSE) +
stat_smooth(method ="auto",se = FALSE, formula = y ~ x, size = 1) +
facet_wrap(hor~year) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))
nh4_trt.plot + scale_colour_brewer(type="seq", palette=3) + xlab("Day of the Year") +ylab("Total NH4)") + theme(text = element_text(size=18))
plot(nh4_trt.plot)
lme(co2flux ~ trt * year, random = ~ 1 | plot, correlation = corAR1(form = ~ 1 | plot),data = resp)
lme(co2flux ~ trt * doy, random = ~ 1 | plot, correlation = corAR1(form = ~ 1 | plot),data = resp)
nlme(inv.simp ~ plot_type * year, random = ~ 1 | plot_id, correlation = corAR1(form = ~ 1 | plot_id),data = div.treat) # Look at detailed output
summary(div.rm1)
nlme(inv.simp ~ plot_type * year, random = ~ 1 | plot_id, correlation = corAR1(form = ~ 1 | plot_id),data = div.treat)
plant.treat.plot = group_by(resp, trt, year) %>%
summarise(mean = mean(inv.simp), sd = sd(inv.simp),n = n(),sem = sd/sqrt(n))
plant.treat.plot = group_by(resp, trt, year) %>%
summarise(mean = mean(co2flux), sd = sd(co2flux),n = n(),sem = sd/sqrt(n))
View(plant.treat.plot)
unique(resp$trt)
lme(co2flux ~ trt * year, random = ~ 1 | plot, correlation = corCompSymm(form = ~ 1 | plot),data = resp)
View(plant)
setwd("/Users/bhbeidler/GitHub/QB2017_DivPro/Data")
plant = read.csv("./HF_plants_treat.csv")
nmin = read.csv("./HF_nmin.csv", stringsAsFactors = FALSE)
resp = read.csv("./HF_soilresp.csv", stringsAsFactors = FALSE)
View(resp)
lme(co2flux ~ N_treat + heat_treat + year, random = ~ 1 | plot, correlation = corCompSymm(form = ~ 1 | plot),data = resp)
resp = na.exclude(resp)
setwd("/Users/bhbeidler/GitHub/QB2017_DivPro/Data")
plant = read.csv("./HF_plants_treat.csv")
nmin = read.csv("./HF_nmin.csv", stringsAsFactors = FALSE)
resp = read.csv("./HF_soilresp.csv", stringsAsFactors = FALSE)
setwd("/Users/bhbeidler/GitHub/QB2017_DivPro/Data")
plant = read.csv("./HF_plants_treat.csv")
nmin = read.csv("./HF_nmin.csv", stringsAsFactors = FALSE)
resp = read.csv("./HF_soilresp.csv", stringsAsFactors = FALSE)
View(resp)
lme(co2flux ~ N_treat + heat_treat  year, random = ~ 1 | plot, correlation = corCompSymm(form = ~ 1 | plot),data = resp)
lme(co2flux ~ N_treat + heat_treat + year, random = ~ 1 | plot, correlation = corCompSymm(form = ~ 1 | plot),data = resp)
resp = na.exclude(resp)
lme(co2flux ~ N_treat + heat_treat + year, random = ~ 1 | plot, correlation = corCompSymm(form = ~ 1 | plot),data = resp)
summary(soil.rm1)
soil.rm1 = lme(co2flux ~ N_treat + heat_treat + year, random = ~ 1 | plot, correlation = corCompSymm(form = ~ 1 | plot),data = resp) # Look at detailed output
summary(soil.rm1)
anova(soil.rm1)
resp = resp %>%
filter(year %in% c( "2006","2007", "2008", "2009"))
resp = na.exclude(resp)
soil.rm1 = lme(co2flux ~ N_treat + heat_treat + year, random = ~ 1 | plot, correlation = corCompSymm(form = ~ 1 | plot),data = resp) # Look at detailed output
summary(soil.rm1) # Obtain F-test
anova(soil.rm1)
soil.rm1 = lme(co2flux ~ year + heat_treat + N_treat * heat_treat * N_treat * year , random = ~ 1 | plot, correlation = corCompSymm(form = ~ 1 | plot),data = resp) # Look at detailed output
summary(soil.rm1) # Obtain F-test
anova(soil.rm1)
soil.rm1 = lme(co2flux ~ year + heat_treat + N_treat * heat_treat * N_treat * year , random = ~ 1 | plot, correlation = corAR1(form = ~ 1 | plot),data = resp) # Look at detailed output
summary(soil.rm1) # Obtain F-test
anova(soil.rm1)
soil.rm2 = lme(co2flux ~ trt * year, random = ~ 1 | plot, correlation = corAR1(form = ~ 1 | resp),data = resp) # Look at detailed output
soil.rm2 = lme(co2flux ~ trt * year, random = ~ 1 | plot, correlation = corAR1(form = ~ 1 | resp),data = resp) # Look at detailed output
soil.rm2 = lme(co2flux ~ year + heat_treat + N_treat * heat_treat * N_treat * year , random = ~ 1 | plot, correlation = corCompSymm(form = ~ 1 | plot),data = resp) # Look at detailed output
summary(soil.rm2) # Obtain F-test
anova(soil.rm2)
# cirCAR1 cnt AR process
soil.rm3 = lme(co2flux ~ year + heat_treat + N_treat * heat_treat * N_treat * year , random = ~ 1 | plot, correlation = corCAR1(form = ~ 1 | plot),data = resp) # Look at detailed output
summary(soil.rm3) # Obtain F-test
anova(soil.rm3)
# corARMA autoregressive moving average process, with arbitrary components
soil.rm4 = lme(co2flux ~ year + heat_treat + N_treat * heat_treat * N_treat * year , random = ~ 1 | plot, correlation = corARMA(form = ~ 1 | plot),data = resp) # Look at detailed output
summary(soil.rm4) # Obtain F-test
anova(soil.rm4)
soil.rm4 = lme(co2flux ~ year + heat_treat + N_treat * heat_treat * N_treat * year , random = ~ 1 | plot, correlation = corARMA(form = ~ 1 | plot),data = resp) # Look at detailed output
summary(soil.rm4) # Obtain F-test
anova(soil.rm4)
#corExp
soil.rm5 = lme(co2flux ~ year + heat_treat + N_treat * heat_treat * N_treat * year , random = ~ 1 | plot, correlation = corExp(form = ~ 1 | plot),data = resp) # Look at detailed output
summary(soil.rm5) # Obtain F-test
anova(soil.rm5)
soil.rm6 = lme(co2flux ~ year + heat_treat + N_treat * heat_treat * N_treat * year , random = ~ 1 | plot, correlation = corGaus(form = ~ 1 | plot),data = resp) # Look at detailed output
summary(soil.rm6) # Obtain F-test
anova(soil.rm6)
plant.treat.plot = group_by(resp, trt, year) %>%
summarise(mean = mean(co2flux), sd = sd(co2flux),n = n(),sem = sd/sqrt(n))
# Trying different variance - covariance structures
# AR(1) covariance structure
soil.rm1 = lme(co2flux ~ year + heat_treat + N_treat * heat_treat * N_treat * year , random = ~ 1 | plot, correlation = corAR1(form = ~ 1 | plot),data = resp)
summary(soil.rm1) # Obtain F-test
anova(soil.rm1)
# corARMA autoregressive moving average proccess
soil.rm2 = lme(co2flux ~ year + heat_treat + N_treat * heat_treat * N_treat * year , random = ~ 1 | plot, correlation = corCompSymm(form = ~ 1 | plot),data = resp) #
summary(soil.rm2) # Obtain F-test
anova(soil.rm2)
# cirCAR1 cnt AR process
soil.rm3 = lme(co2flux ~ year + heat_treat + N_treat * heat_treat * N_treat * year , random = ~ 1 | plot, correlation = corCAR1(form = ~ 1 | plot),data = resp)
summary(soil.rm3) # Obtain F-test
anova(soil.rm3)
# corARMA autoregressive moving average process, with arbitrary components
soil.rm4 = lme(co2flux ~ year + heat_treat + N_treat * heat_treat * N_treat * year , random = ~ 1 | plot, correlation = corARMA(form = ~ 1 | plot),data = resp)
summary(soil.rm4) # Obtain F-test
anova(soil.rm4)
#corExp exponential spatial correlation.
soil.rm5 = lme(co2flux ~ year + heat_treat + N_treat * heat_treat * N_treat * year , random = ~ 1 | plot, correlation = corExp(form = ~ 1 | plot),data = resp)
summary(soil.rm5) # Obtain F-test
anova(soil.rm5)
# CorGaus Gaussian spatial correlation.
soil.rm6 = lme(co2flux ~ year + heat_treat + N_treat * heat_treat * N_treat * year , random = ~ 1 | plot, correlation = corGaus(form = ~ 1 | plot),data = resp)
summary(soil.rm6) # Obtain F-test
anova(soil.rm6)
# corLin	linear spatial correlation.
soil.rm7 = lme(co2flux ~ year + heat_treat + N_treat * heat_treat * N_treat * year , random = ~ 1 | plot, correlation = corLin(form = ~ 1 | plot),data = resp) #
summary(soil.rm7) # Obtain F-test
anova(soil.rm7)
# corRatio	Rational quadratics spatial correlation.
soil.rm8 = lme(co2flux ~ year + heat_treat + N_treat * heat_treat * N_treat * year , random = ~ 1 | plot, correlation = corRatio(form = ~ 1 | plot),data = resp) #
summary(soil.rm8) # Obtain F-test
anova(soil.rm8)
# corRatioSpher	spherical spatial correlation
soil.rm9 = lme(co2flux ~ year + heat_treat + N_treat * heat_treat * N_treat * year , random = ~ 1 | plot, correlation = corSpher(form = ~ 1 | plot),data = resp) #
summary(soil.rm9) # Obtain F-test
anova(soil.rm9)
# corSymm general correlation matrix, with no additional structure
soil.rm10 = lme(co2flux ~ year + heat_treat + N_treat * heat_treat * N_treat * year , random = ~ 1 | plot, correlation = corSpher(form = ~ 1 | plot),data = resp) #
summary(soil.rm10) # Obtain F-test
anova(soil.rm10)
# Compare the AICs
AIC()
lme(co2flux ~ year + heat_treat + N_treat * heat_treat * N_treat * year , random = ~ 1 | plot, correlation = corARMA(form = ~ 1 | plot),data = resp)
getGroupsFormula.default(correlation, asList = TRUE)
soil.rm4 = lme(co2flux ~ year + heat_treat + N_treat * heat_treat * N_treat * year , random = ~ 1 | plot, correlation = corARMA(form = ~ 1 | plot, p = 1, q = 1),data = resp)
summary(soil.rm4) # Obtain F-test
anova(soil.rm4)
AIC(soil.rm1, soil.rm2, soil.rm3,soil.rm4, soil.rm5, soil.rm6,soil.rm7,soil.rm8,soil.rm9,soil.rm10)
soil.rm10 = lme(co2flux ~ year + heat_treat + N_treat * heat_treat * N_treat * year , random = ~ 1 | plot, correlation = corSpher(form = ~ 1 | plot),data = resp) #
summary(soil.rm10) # Obtain F-test
anova(soil.rm10)
setwd("/Users/bhbeidler/GitHub/QB2017_DivPro/Data")
plant = read.csv("./HF_plants_treat.csv")
nmin = read.csv("./HF_nmin.csv", stringsAsFactors = FALSE)
resp = read.csv("./HF_soilresp.csv", stringsAsFactors = FALSE)
resp = na.exclude(resp)
plant.treat.plot = group_by(resp, trt, year) %>%
summarise(mean = mean(co2flux), sd = sd(co2flux),n = n(),sem = sd/sqrt(n))
# Trying different variance - covariance structures
# AR(1) covariance structure
soil.rm1 = lme(co2flux ~ year + heat_treat + N_treat * heat_treat * N_treat * year , random = ~ 1 | plot, correlation = corAR1(form = ~ 1 | plot),data = resp)
summary(soil.rm1) # Obtain F-test
anova(soil.rm1)
# corARMA autoregressive moving average proccess
soil.rm2 = lme(co2flux ~ year + heat_treat + N_treat * heat_treat * N_treat * year , random = ~ 1 | plot, correlation = corCompSymm(form = ~ 1 | plot),data = resp) #
summary(soil.rm2) # Obtain F-test
anova(soil.rm2)
# cirCAR1 cnt AR process
soil.rm3 = lme(co2flux ~ year + heat_treat + N_treat * heat_treat * N_treat * year , random = ~ 1 | plot, correlation = corCAR1(form = ~ 1 | plot),data = resp)
summary(soil.rm3) # Obtain F-test
anova(soil.rm3)
# corARMA autoregressive moving average process, with arbitrary components
soil.rm4 = lme(co2flux ~ year + heat_treat + N_treat * heat_treat * N_treat * year , random = ~ 1 | plot, correlation = corARMA(form = ~ 1 | plot, p = 1, q = 1),data = resp)
summary(soil.rm4) # Obtain F-test
anova(soil.rm4)
#corExp exponential spatial correlation.
soil.rm5 = lme(co2flux ~ year + heat_treat + N_treat * heat_treat * N_treat * year , random = ~ 1 | plot, correlation = corExp(form = ~ 1 | plot),data = resp)
summary(soil.rm5) # Obtain F-test
anova(soil.rm5)
# CorGaus Gaussian spatial correlation.
soil.rm6 = lme(co2flux ~ year + heat_treat + N_treat * heat_treat * N_treat * year , random = ~ 1 | plot, correlation = corGaus(form = ~ 1 | plot),data = resp)
summary(soil.rm6) # Obtain F-test
anova(soil.rm6)
# corLin	linear spatial correlation.
soil.rm7 = lme(co2flux ~ year + heat_treat + N_treat * heat_treat * N_treat * year , random = ~ 1 | plot, correlation = corLin(form = ~ 1 | plot),data = resp) #
summary(soil.rm7) # Obtain F-test
anova(soil.rm7)
# corRatio	Rational quadratics spatial correlation.
soil.rm8 = lme(co2flux ~ year + heat_treat + N_treat * heat_treat * N_treat * year , random = ~ 1 | plot, correlation = corRatio(form = ~ 1 | plot),data = resp) #
summary(soil.rm8) # Obtain F-test
anova(soil.rm8)
# corRatioSpher	spherical spatial correlation
soil.rm9 = lme(co2flux ~ year + heat_treat + N_treat * heat_treat * N_treat * year , random = ~ 1 | plot, correlation = corSpher(form = ~ 1 | plot),data = resp) #
summary(soil.rm9) # Obtain F-test
anova(soil.rm9)
# corSymm general correlation matrix, with no additional structure
soil.rm10 = lme(co2flux ~ year + heat_treat + N_treat * heat_treat * N_treat * year , random = ~ 1 | plot, correlation = corSpher(form = ~ 1 | plot),data = resp) #
summary(soil.rm10) # Obtain F-test
anova(soil.rm10)
# Compare the AICs
AIC(soil.rm1, soil.rm2, soil.rm3,soil.rm4, soil.rm5, soil.rm6,soil.rm7,soil.rm8,soil.rm9,soil.rm10)
# The unstructured covariance matrix has the lowest AIC score ??
